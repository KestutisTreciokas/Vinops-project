# Roles & Policy — PostgreSQL 17

## Роли
- **admin**  
  Область: администрирование схемы и данных (локально по SSH).  
  Права: CREATE/ALTER/DROP объектов, DML, управление индексами/расширениями.  
  Ограничения: суперправа в рутине запрещены.

- **etl_rw**  
  Область: конвейер загрузки (Copart CSV → normalize).  
  Права: INSERT/UPDATE/DELETE/UPSERT в таблицы `vehicles`, `lots`, `sale_events`, `images` и вспомогательные словари.  
  Ограничения: **нет DDL**, нет прав на расширения/схемы.

- **app_ro**  
  Область: публичное чтение (API/SSR).  
  Права: SELECT на `vehicles`, `lots`, `sale_events`, `images` и необходимые представления.  
  Ограничения: запрет COPY TO PROGRAM, COPY из вне табличных пространств.

- **backup**  
  Область: резервное копирование/восстановление (локально).  
  Права: чтение системных каталогов/данных, запуск процедур бэкапа/restore.  
  Ограничения: нет DDL/DML над прикладными таблицами.

## Схемы/Именование
- Схема по умолчанию: `public` (MVP).  
  В будущем: выделенные схемы `etl`, `api` — отдельной миграцией.
- Индексы под поиск VIN: `pg_trgm` и BTREE на `vin_normalized`.

## Принцип доступа
- Принцип наименьших привилегий, доступ по IP — см. `infra/network/access.md`.  
- Аутентификация: SCRAM, TLS — по плану (включение при внешних клиентах).

