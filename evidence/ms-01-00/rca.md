# RCA: инцидент «404/белый экран» (vinops.online)

**Симптомы:** пользователи периодически видели пустой экран/404 на отдельных маршрутах; на корне `/` ответ 308 шёл без `Strict-Transport-Security`, что зафиксировало QA. Проверки показали, что SSR на ключевых страницах сейчас отдаёт непустой HTML (200), но security-заголовки были неполными.

**Корневая причина и фикс:** (1) на уровне origin отсутствовала установка HSTS для всех ответов, из-за чего профиль Security-Headers деградировал на редиректе `/` (308); (2) в логах Next.js присутствуют ошибки прав доступа к `.next/cache` (`EACCES`) — это создаёт риск нестабильного пререндер-кеша и побочных 404. В рамках MS-01-00 включён HSTS на уровне Caddy для всех ответов (включая 3xx). В рамках предотвращения регресса: добавим смоки на наличие HSTS в `HEAD /`, а исправление прав/владельца `.next/cache` оформим в следующий мини-спринт (Dockerfile/entrypoint + CI-линт).

**Профилактика:** автоматизировать выгрузку настроек Cloudflare (SSL/HSTS/Rulesets) артефактами CI; закрепить чек S1 на `Referrer-Policy`, `X-Content-Type-Options` и `Strict-Transport-Security` для `/`, `/ru`, `/en`, `/[lang]/cars`.
