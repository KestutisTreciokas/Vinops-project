# S1 / MS-01-00 RCA — outage 404 on root

**Дата/время (Europe/Warsaw):** 2025-09-27  
**Симптом:** `/` отдавал 200/404 без редиректа на `/en`, NEG-URL иногда 200 через CF.  
**Причина:** конфигурация Caddy с общим `handle { reverse_proxy … }` перехватывала запросы раньше правил редиректа, из-за чего редиректы не срабатывали.  
**Решение:** переписан Caddyfile на детерминированную схему — *явные* `redir / → /en 308` и `redir @noLocale → /en{uri} 308` **до** `reverse_proxy web:3000`.  
**Доказательства:**  
- ORIGIN bypass: `/` → `308 /en`, `/en` → `200`, NEG → `308 → /en/NEG → 404` (см. `after_fix/*.txt`).  
- Через CF: те же признаки; `robots.txt`/`sitemap.xml` — `200` с корректными `Content-Type`.  
**Профилактика:** при изменениях периметра запускать smoke: `HEAD /` (ожидаем 308), `HEAD -L /` (200 на `/en`), `HEAD -L /__neg__` (404), `robots.txt`/`sitemap.xml` (200).
